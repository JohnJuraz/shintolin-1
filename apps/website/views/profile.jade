extends ./_page.jade

mixin profile_date(date, label)
  div
    label #{label}
    p(title='#{moment(date).format("MMM Do, YYYY H:mm A")}') #{moment(date).fromNow()}

block content
  .jumbotron
    .container
      .row
        .col-xs-12
          h1 #{character.name}
          if character.settlement_id
            h2
              | of
              |  
              a(href='/settlements/#{character.settlement_slug}') #{character.settlement_name}

  .container
    .row
      .col-xs-12

        if editable || is_developer
          ul.nav.nav-tabs(role='tablist')
            li.active(role='presentation'): a(href='#profile', aria-controls='profile', role='tab', data-toggle='tab') Profile
            li(role='presentation'): a(href='#edit-profile', aria-controls='edit-profile', role='tab', data-toggle='tab') Edit
            if is_developer
              li(role='presentation'): a(href='#moderation', aria-controls='moderation', role='tab', data-toggle='tab') Moderation

        .tab-content(class={'profile-read-only': (!editable && !is_developer)})
          #profile.tab-pane.active(role='tabpanel')
            include ./profile-view
          if editable || is_developer
            #edit-profile.tab-pane(role='tabpanel')
              include ./profile-edit
          if is_developer
            #moderation.tab-pane(role='tabpanel')
              h2.page-title Moderation Tools
              div
                label Email Address
                p: a(href="mailto:#{character.email}") #{character.email}
              div
                label Played For
                p #{moment.duration(moment(character.last_action).diff(character.created)).humanize()}
              mixin profile_date(character.last_action, 'Last Active')
              form(method='POST', action='/game/dev/possess')
                input(type='hidden', name='_csrf', value=csrf)
                input(type='hidden', name='target_name', value=character.name)
                button.btn.btn-default(type='submit') Possess
              form(method='POST', action='/game/dev/teleport-to-character')
                input(type='hidden', name='_csrf', value=csrf)
                input(type='hidden', name='target_name', value=character.name)
                button.btn.btn-default(type='submit') Teleport To
              form(method='POST', action='/game/dev/remove-player/#{character.slug}')
                input(type='hidden', name='_csrf', value=csrf)
                button.btn.btn-danger(type='submit') Delete
